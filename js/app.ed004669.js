(function(e){function t(t){for(var n,s,a=t[0],u=t[1],c=t[2],d=0,p=[];d<a.length;d++)s=a[d],o[s]&&p.push(o[s][0]),o[s]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);l&&l(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,a=1;a<r.length;a++){var u=r[a];0!==o[u]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},o={app:0},i=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/youtrack-time-sync/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var l=u;i.push([1,"chunk-vendors"]),r()})({0:function(e,t){},1:function(e,t,r){e.exports=r("cd49")},2:function(e,t){},2041:function(e,t,r){"use strict";var n=r("8e72"),o=r.n(n);o.a},"2fb4":function(e,t,r){},3:function(e,t){},"6ee4":function(e,t,r){"use strict";var n=r("2fb4"),o=r.n(n);o.a},"8e72":function(e,t,r){},9224:function(e){e.exports={name:"youtrack-time-sync",author:{name:"Andreas Huber Dönni"},keywords:["youtrack","time-sync"],description:"Sync spent time entries in youtrack according to the working time you keep in an Excel file.",homepage:"https://github.com/andreashuber69/youtrack-time-sync/blob/master/README.md#--",version:"0.1.14",license:"GPL-3.0-or-later",repository:{type:"git",url:"https://github.com/andreashuber69/youtrack-time-sync.git"},bugs:{url:"https://github.com/andreashuber69/youtrack-time-sync/issues"},private:!0,scripts:{"serve-development":"vue-cli-service serve --mode development","preserve-production":"npm run lint","serve-production":"vue-cli-service serve --mode production",prebuild:"npm run lint",build:"cross-env WEBPACK_BASE_URL=/youtrack-time-sync vue-cli-service build",lint:"tslint --project tsconfig.json --config tslint.json --format verbose",test:"npm run build"},dependencies:{vue:"^2.5.17","vue-class-component":"^6.0.0","vue-property-decorator":"^7.0.0",vuetify:"^1.3.0",xlsx:"^0.14.0"},devDependencies:{"@vue/cli-plugin-typescript":"^3.1.1","@vue/cli-service":"^3.1.1","cross-env":"^5.2.0",stylus:"^0.54.5","stylus-loader":"^3.0.1",typescript:"^3.0.0","vue-cli-plugin-vuetify":"^0.4.5","vue-template-compiler":"^2.5.17","vuetify-loader":"^1.0.5"},postcss:{plugins:{autoprefixer:{}}},browserslist:[">= 0%","not Chrome < 54","not ChromeAndroid < 54","not Android < 5","not Firefox < 47","not FirefoxAndroid < 47","not Edge < 14","not Safari < 10","not iOS < 10","not Opera < 41","not OperaMini all","not Samsung < 5","not Explorer < 12","not ExplorerMobile < 12","not Baidu < 8","not QQAndroid < 2","not UCAndroid < 12","not dead"]}},b318:function(e,t,r){"use strict";var n=r("e8f4"),o=r.n(n);o.a},cd49:function(e,t,r){"use strict";r.r(t);var n=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-navigation-drawer",{attrs:{app:"",dark:"",temporary:""},model:{value:e.isDrawerVisible,callback:function(t){e.isDrawerVisible=t},expression:"isDrawerVisible"}},[r("v-list",{attrs:{dense:""}},[r("v-list-tile",{on:{click:e.onAboutClicked}},[r("v-list-tile-action",[r("v-icon",[e._v("help")])],1),r("v-list-tile-content",[r("v-list-tile-title",[e._v("About")])],1)],1)],1)],1),r("v-toolbar",{attrs:{app:"",dark:""}},[r("v-toolbar-side-icon",{on:{click:function(t){return t.stopPropagation(),e.onMenuClicked(t)}}}),r("v-toolbar-title",{staticClass:"hidden-xs-only"},[r("v-icon",[e._v("sync")]),e._v("  "+e._s(e.model.title))],1),r("v-spacer")],1),r("v-content",[r("Content",{attrs:{model:e.model}}),r("AboutDialog",{ref:"aboutDialog"})],1)],1)},i=[],s=r("9ab4"),a=r("60a3"),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{width:"960px"},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v(e._s(e.title))]),r("v-container",{attrs:{"grid-list-md":"","text-xs-center":""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card",{attrs:{flat:""}},[r("v-card-text",{staticClass:"subheading px-0"},[e._v("Copyright © 2018 Andreas Huber Dönni")])],1)],1),r("v-flex",{attrs:{xs12:"",sm4:""}},[r("v-btn",{staticClass:"ma-0",attrs:{href:"https://github.com/andreashuber69/"+e.packageName+"/blob/master/README.md#--",target:"_blank",color:"primary",block:"",flat:""}},[e._v("\n            Documentation\n          ")])],1),r("v-flex",{attrs:{xs12:"",sm4:""}},[r("v-btn",{staticClass:"ma-0",attrs:{href:"https://github.com/andreashuber69/"+e.packageName+"/issues",target:"_blank",color:"primary",block:"",flat:""}},[e._v("\n            Issues\n          ")])],1),r("v-flex",{attrs:{xs12:"",sm4:""}},[r("v-btn",{staticClass:"ma-0",attrs:{href:"https://raw.githubusercontent.com/andreashuber69/"+e.packageName+"/master/LICENSE",target:"_blank",color:"primary",block:"",flat:""}},[e._v("\n            License\n          ")])],1),r("v-flex",{attrs:{xs12:""}},[r("v-card",{attrs:{flat:""}},[r("v-card-text",{staticClass:"caption px-0"},[e._v(e._s(e.userAgent))])],1)],1)],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.isOpen=!1}}},[e._v("Close")])],1)],1)],1)},c=[],l=r("9224"),d=function(){function e(){}return Object.defineProperty(e,"packageName",{get:function(){return l.name},enumerable:!0,configurable:!0}),Object.defineProperty(e,"title",{get:function(){return this.packageName.split("-").map(function(e){return""+e[0].toUpperCase()+e.substr(1)}).join(" ")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"version",{get:function(){return l.version},enumerable:!0,configurable:!0}),e}(),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isOpen=!1,t}return s["c"](t,e),Object.defineProperty(t.prototype,"title",{get:function(){return d.title+" v"+d.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"packageName",{get:function(){return d.packageName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{get:function(){return window.navigator.userAgent},enumerable:!0,configurable:!0}),t.prototype.showDialog=function(){this.isOpen=!0},t=s["b"]([a["a"]],t),t}(a["c"]),f=p,h=f,m=(r("6ee4"),r("2877")),y=r("6544"),b=r.n(y),v=r("8336"),g=r("b0af"),k=r("99d9"),w=r("12b2"),x=r("a523"),T=r("169a"),E=r("0e8f"),S=r("a722"),M=r("9910"),_=Object(m["a"])(h,u,c,!1,null,"1e2a732e",null);_.options.__file="AboutDialog.vue";var I=_.exports;b()(_,{VBtn:v["a"],VCard:g["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:w["a"],VContainer:x["a"],VDialog:T["a"],VFlex:E["a"],VLayout:S["a"],VSpacer:M["a"]});var P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-container",{attrs:{"grid-list-lg":""}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{label:"YouTrack Base URL",hint:"Example: 'https://company.myjetbrains.com",required:"",autofocus:e.focusUrl,rules:e.rules,"error-messages":e.networkError},model:{value:e.checkedModel.youTrackBaseUrl,callback:function(t){e.$set(e.checkedModel,"youTrackBaseUrl",t)},expression:"checkedModel.youTrackBaseUrl"}})],1),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{label:"YouTrack Authentication Token",hint:"Example: 'perm:QUhV.VGVzdDI=.6fRv9xZztORX9LquKaXJHxf5lsKyoO'",required:"",autofocus:e.focusToken,rules:e.rules,"error-messages":e.networkError,"append-icon":e.showToken?"visibility_off":"visibility",type:e.showToken?"text":"password"},on:{"click:append":function(t){e.showToken=!e.showToken}},model:{value:e.checkedModel.youTrackToken,callback:function(t){e.$set(e.checkedModel,"youTrackToken",t)},expression:"checkedModel.youTrackToken"}})],1),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{ref:"excelFileField",attrs:{label:"Excel File",required:"",readonly:"",disabled:e.disableFile,rules:e.rules,"error-messages":e.fileError,"append-icon":"open_in_browser"},on:{"click:append":function(t){e.$refs.fileInput.click()}},model:{value:e.checkedModel.filename,callback:function(t){e.$set(e.checkedModel,"filename",t)},expression:"checkedModel.filename"}}),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:e.checkedModel.fileExtension},on:{change:e.onFileInputChanged}})],1),r("v-flex",{attrs:{xs12:""}},[r("v-card",[r("v-card-title",[r("h3",{staticClass:"headline"},[e._v("Unreported Spent Time")])]),r("v-data-table",{attrs:{headers:e.timeHeaders,items:e.checkedModel.times,"no-data-text":e.noSpentTimeText,loading:e.isLoading,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.date.toLocaleDateString()))]),r("td",[e._v(e._s(t.item.title))]),r("td",[e._v(e._s(t.item.summary))]),r("td",[e._v(e._s(t.item.type))]),r("td",{staticStyle:{"white-space":"pre"}},[e._v(e._s(t.item.comments.join("\n")))]),r("td",{staticClass:"text-xs-right"},[e._v(e._s((t.item.durationMinutes/60).toFixed(2)+"h"))])]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1),r("v-flex",{attrs:{xs12:""}},[r("v-layout",{attrs:{"justify-center":""}},[r("v-btn",{attrs:{color:"primary",disabled:!e.valid||0===e.checkedModel.times.length},on:{click:e.onReportNowClicked}},[e._v("\n            Report Now\n          ")])],1)],1)],1)],1),r("StatusSnackbar",{ref:"statusSnackbar"})],1)},C=[],V=r("1146"),O=function(){function e(e,t){var r,n,o,i;this.roundingMinutes=t,this.map=new Map;try{for(var a=s["g"](e),u=a.next();!u.done;u=a.next()){var c=u.value;this.addSingle(c)}}catch(p){r={error:p}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}try{for(var l=s["g"](this.map.values()),d=l.next();!d.done;d=l.next()){c=d.value;this.roundDuration(c)}}catch(f){o={error:f}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}}return e.prototype.uniqueTitles=function(){return s["f"](new Set(s["f"](this.map.values()).map(function(e){return e.title})))},e.prototype.subtract=function(e){var t,r;try{for(var n=s["g"](e),o=n.next();!o.done;o=n.next()){var i=o.value;this.subtractSingle(i)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.entries=function(){var t=s["f"](this.map.values());return t.sort(function(t,r){return e.compare(t,r)}),t},e.compare=function(e,t){return e.date.getTime()-t.date.getTime()||e.title.localeCompare(t.title)||(e.type||"").localeCompare(t.type||"")||0},e.add=function(e,t){return e.includes(t)||e.push(t),e},e.prototype.addSingle=function(t){var r=s["e"](this.findExisting(t),2),n=r[0],o=r[1];o?(o.durationMinutes+=t.durationMinutes,t.comments.reduce(function(t,r){return e.add(t,r)},o.comments)):this.map.set(n,t)},e.prototype.subtractSingle=function(e){var t=s["e"](this.findExisting(e),2),r=t[0],n=t[1];if(this.roundDuration(e),!n||n.durationMinutes<e.durationMinutes){var o=e.date.toLocaleDateString();throw new Error("Spent time entries for issue "+e.title+" on "+o+" cannot be matched to the Excel file.")}n.durationMinutes-=e.durationMinutes,0===n.durationMinutes&&this.map.delete(r)},e.prototype.findExisting=function(e){var t=e.date.getTime()+"|"+e.title+"|"+e.type;return[t,this.map.get(t)]},e.prototype.roundDuration=function(e){e.durationMinutes=Math.round(e.durationMinutes/this.roundingMinutes)*this.roundingMinutes},e}(),D=function(){function e(){}return e.parse=function(e){var t,r,n,o,i,a,u,c,l,d,p,f,h;return s["d"](this,function(m){switch(m.label){case 0:i=!1,m.label=1;case 1:m.trys.push([1,12,13,14]),a=s["g"](e.SheetNames),u=a.next(),m.label=2;case 2:if(u.done)return[3,11];c=u.value,m.label=3;case 3:m.trys.push([3,8,9,10]),l=s["g"](this.parseSheet(e.Sheets[c],c)),d=l.next(),m.label=4;case 4:return d.done?[3,7]:(p=d.value,i=!0,[4,p]);case 5:m.sent(),m.label=6;case 6:return d=l.next(),[3,4];case 7:return[3,10];case 8:return f=m.sent(),n={error:f},[3,10];case 9:try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}return[7];case 10:return u=a.next(),[3,2];case 11:return[3,14];case 12:return h=m.sent(),t={error:h},[3,14];case 13:try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}return[7];case 14:if(!i)throw new Error("The selected workbook does not seem to contain any Week sheets.");return[2]}})},e.parseSheet=function(e,t){var r,n,o,i,a,u,c,l,d;return s["d"](this,function(p){switch(p.label){case 0:if(!t.startsWith("Week"))return[2];if(r=e["!ref"],!r)throw new Error("The sheet "+t+" seems to be empty.");return n=r.indexOf(":"),this.checkRange(n<0,t,r),o=s["e"](this.split(r.substring(0,n),t,r),2),i=o[0],a=o[1],u=s["e"](this.split(r.substring(n+1,r.length),t,r),2),c=u[0],l=u[1],d=5,this.checkRange("A"!==i||"G"!==c||1!==a||l<d,t,r),[5,s["g"](this.iterateRows(d,l,t,e))];case 1:return p.sent(),[2]}})},e.checkRange=function(e,t,r){if(e)throw new Error("The sheet "+t+" has an unexpected range: "+r+".")},e.iterateRows=function(e,t,r,n){var o;return s["d"](this,function(i){switch(i.label){case 0:o=e,i.label=1;case 1:return o<=t?[5,s["g"](this.parseRow({errorPrefix:"In sheet "+r+", ",row:o,holidays:n["A"+o],otherPaidAbsence:n["B"+o],start:n["C"+o],end:n["D"+o],title:n["E"+o],type:n["F"+o],comment:n["G"+o]}))]:[3,4];case 2:i.sent(),i.label=3;case 3:return++o,[3,1];case 4:return[2]}})},e.parseRow=function(e){var t,r,n,o,i,a,u,c;return s["d"](this,function(l){switch(l.label){case 0:if(t=this.getPeriod(e),!t)return[2];if(r=s["e"](t,2),n=r[0],o=r[1],i=this.getSpentTime(o,n,e),a=s["e"](this.getWorkDetail(e,n,o),2),u=a[0],c=a[1],void 0!==n.f)return[3,2];if(!c)throw new Error(e.errorPrefix+"E"+e.row+" must not be empty.");return c.includes("-")?[4,{date:this.toDate(n.v),title:c,type:e.type&&e.type.v.toString()||void 0,comments:e.comment&&e.comment.v.toString().split("\n").map(function(e){return e.trim()}).filter(function(e){return!!e})||[],isPaidAbsence:u,durationMinutes:24*i*60}]:[3,2];case 1:l.sent(),l.label=2;case 2:return[2]}})},e.split=function(e,t,r){var n=e.search("[0-9]+");return this.checkRange(n<0,t,r),[e.substring(0,n),Number.parseInt(e.substring(n,e.length),10)]},e.getPeriod=function(e){if(!e.start!==!e.end)throw new Error(e.errorPrefix+"C"+e.row+" and D"+e.row+" must either be both empty or non-empty.");if(e.start&&e.end){if("number"!==typeof e.start.v||"number"!==typeof e.end.v)throw new Error(e.errorPrefix+"C"+e.row+" and D"+e.row+" must both be dates.");return[{v:e.start.v,f:e.start.f},{v:e.end.v,f:e.end.f}]}},e.getSpentTime=function(e,t,r){var n=e.v-t.v;if(Math.abs(n)<1/24/60/60&&(n=0),n<0)throw new Error(r.errorPrefix+"C"+r.row+" must be smaller than D"+r.row+".");if(n>=1)throw new Error(r.errorPrefix+"on row "+r.row+" the spent time must be smaller than 1 day.");return n},e.getWorkDetail=function(e,t,r){if(e.holidays&&e.otherPaidAbsence)throw new Error(e.errorPrefix+"A"+e.row+" and B"+e.row+" cannot both be non-empty.");var n=!!e.holidays||!!e.otherPaidAbsence;if(n){if(void 0!==t.f||void 0===r.f)throw new Error(e.errorPrefix+"C"+e.row+" must be fixed and D"+e.row+" must be floating.");return[n,e.holidays?"Holiday":"Other Paid Absence"]}if(void 0===t.f!==(void 0===r.f))throw new Error(e.errorPrefix+"C"+e.row+" and D"+e.row+" must either be both values or both formulas.");return[n,e.title&&e.title.v&&e.title.v.toString()||void 0]},e.toDate=function(e){return new Date(24*Math.floor(this.excelEpochStart.getTime()/1e3/60/60/24+e)*60*60*1e3)},e.excelEpochStart=new Date(1899,11,30),e}(),U=function(){function e(e){this.spentTimes=new O(D.parse(Object(V["read"])(new Uint8Array(e),{type:"array"})),15)}return e.create=function(t){return s["a"](this,void 0,void 0,function(){var r;return s["d"](this,function(n){switch(n.label){case 0:return r=e.bind,[4,this.read(t)];case 1:return[2,new(r.apply(e,[void 0,n.sent()]))]}})})},e.prototype.subtractExistingSpentTimes=function(e,t){return s["a"](this,void 0,void 0,function(){var r,n,o,i,a,u,c,l,d,p;return s["d"](this,function(f){switch(f.label){case 0:return o=this.spentTimes.uniqueTitles(),[4,e.getWorkItemsForUser(t,o)];case 1:return i=f.sent(),this.subtractNewSpentTimes(i),[4,e.getIssues(this.spentTimes.uniqueTitles())];case 2:a=f.sent(),u=this.spentTimes.entries(),c=function(e){var t=a.find(function(t){return t.id===e.title});e.summary=t&&t.summary};try{for(l=s["g"](u),d=l.next();!d.done;d=l.next())p=d.value,c(p)}catch(h){r={error:h}}finally{try{d&&!d.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return[2,u]}})})},e.prototype.subtractNewSpentTimes=function(t){return this.spentTimes.subtract(e.convert(t)),this.spentTimes.entries()},e.convert=function(e){var t,r,n,o,i,a;return s["d"](this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=s["g"](e),o=n.next(),u.label=1;case 1:return o.done?[3,4]:(i=o.value,[4,{date:new Date(i.date),title:i.issue.id,type:i.type&&i.type.name||void 0,isPaidAbsence:!1,comments:i.text&&i.text.split("\n").map(function(e){return e.trim()})||[],durationMinutes:i.duration.minutes}]);case 2:u.sent(),u.label=3;case 3:return o=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),t={error:a},[3,7];case 6:try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}})},e.read=function(e){return new Promise(function(t,r){var n=new FileReader;n.onload=function(e){return t(n.result)},n.onerror=function(e){return r("Unable to read file.")},n.readAsArrayBuffer(e)})},e}(),A=function(){function e(e,t){this.baseUrl=e,this.headersInit=new Headers([["Accept","application/json"],["Authorization","Bearer "+t],["Cache-Control","no-cache"],["Content-Type","application/json"]])}return e.prototype.getCurrentUser=function(){return this.get("youtrack/api/admin/users/me")},e.prototype.getIssue=function(e){return s["a"](this,void 0,void 0,function(){var t,r;return s["d"](this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.get("youtrack/api/issues/"+e,[["fields","id,summary"]])];case 1:return t=n.sent(),t.id=e,[2,t];case 2:throw r=n.sent(),new Error('Failed to get issue id "'+e+'": '+(r instanceof Error&&r.message||r));case 3:return[2]}})})},e.prototype.getIssues=function(e){var t=this;return Promise.all(s["f"](e).map(function(e){return t.getIssue(e)}))},e.prototype.getWorkItems=function(t){return s["a"](this,void 0,void 0,function(){var r,n,o,i,a,u,c;return s["d"](this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.get(e.getWorkItemsPath(t),e.workItemsParams)];case 1:return o=l.sent(),[3,3];case 2:throw i=l.sent(),new Error('Failed to get work items for issue id "'+t+'": '+(i instanceof Error&&i.message||i));case 3:try{for(a=s["g"](o),u=a.next();!u.done;u=a.next())c=u.value,c.issue.id=t}catch(d){r={error:d}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return[2,o]}})})},e.prototype.getWorkItemsForUser=function(e,t){return s["a"](this,void 0,void 0,function(){var r,n,o=this;return s["d"](this,function(i){switch(i.label){case 0:return[4,Promise.all(s["f"](t).map(function(e){return o.getWorkItems(e)}))];case 1:return n=i.sent(),[2,(r=new Array).concat.apply(r,s["f"](n)).filter(function(t){return t.creator.id===e.id})]}})})},e.prototype.getWorkItemTypes=function(){return this.get("youtrack/api/admin/timeTrackingSettings/workItemTypes",[["fields","id,name"]])},e.prototype.createWorkItem=function(t,r){return s["a"](this,void 0,void 0,function(){var n;return s["d"](this,function(o){switch(o.label){case 0:return[4,this.post(e.getWorkItemsPath(t),e.workItemsParams,r)];case 1:return n=o.sent(),n.issue.id=t,[2,n]}})})},e.getWorkItemsPath=function(e){return"youtrack/api/issues/"+e+"/timeTracking/workItems"},e.parse=function(e){var t;try{t=JSON.parse(e)}catch(r){throw new Error("Parse Failure: "+r)}if(null===t)throw new Error("Unexpected null response.");return t},e.prototype.get=function(e,t){return this.fetch(e,"GET",t)},e.prototype.post=function(e,t,r){return this.fetch(e,"POST",t,r)},e.prototype.fetch=function(t,r,n,o){return s["a"](this,void 0,void 0,function(){var i,a,u,c,l,d,p,f,h,m;return s["d"](this,function(y){switch(y.label){case 0:if(c=new URL(t,this.baseUrl),n)try{for(l=s["g"](n),d=l.next();!d.done;d=l.next())p=d.value,c.searchParams.append(p[0],p[1])}catch(b){i={error:b}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}y.label=1;case 1:return y.trys.push([1,3,,4]),[4,window.fetch(c.href,this.getInit(r,o))];case 2:return u=y.sent(),[3,4];case 3:throw f=y.sent(),new Error("Network Error: "+f);case 4:if(!u.ok)throw new Error("Response Status: "+u.status+" "+u.statusText);return m=(h=e).parse,[4,u.text()];case 5:return[2,m.apply(h,[y.sent()])]}})})},e.prototype.getInit=function(e,t){return{method:e,headers:this.headersInit,body:JSON.stringify(t),mode:"cors"}},e.workItemsParams=[["fields","creator(id),date,duration(minutes),issue(id),text,type(name)"]],e}(),j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-snackbar",{attrs:{color:e.color,timeout:e.timeout},model:{value:e.isVisible,callback:function(t){e.isVisible=t},expression:"isVisible"}},[e._v("\n  "+e._s(e.message)),r("v-btn",{attrs:{dark:"",flat:""},on:{click:function(t){e.isVisible=!1}}},[e._v("Close")])],1)},L=[],B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.color=null,t.message=null,t.isVisible=!1,t.timeout=null,t}return s["c"](t,e),t.prototype.showInfo=function(e){this.show("success",e)},t.prototype.showError=function(e){this.show("error",e,0)},t.prototype.show=function(e,t,r){void 0===r&&(r=6e3),this.color=e,this.message=t,this.isVisible=!0,this.timeout=r},t=s["b"]([a["a"]],t),t}(a["c"]),F=B,N=F,R=(r("2041"),r("2db4")),W=Object(m["a"])(N,j,L,!1,null,null,null);W.options.__file="StatusSnackbar.vue";var $=W.exports;b()(W,{VBtn:v["a"],VSnackbar:R["a"]});var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.valid=!1,t.showToken=!1,t.rules=[function(e){return!!e||"A value is required."}],t.networkError=null,t.fileError=null,t.timeHeaders=[{text:"Date",sortable:!1},{text:"ID",sortable:!1},{text:"Summary",sortable:!1},{text:"Type",sortable:!1},{text:"Comment",sortable:!1},{text:"Spent Time",align:"right",sortable:!1}],t.noSpentTimeText=r.defaultNoSpentTimeText,t.isLoading=!1,t}var r;return s["c"](t,e),r=t,Object.defineProperty(t.prototype,"focusUrl",{get:function(){return!this.checkedModel.youTrackBaseUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusToken",{get:function(){return!this.focusUrl&&!this.checkedModel.youTrackToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disableFile",{get:function(){return!this.checkedModel.youTrackBaseUrl||!this.checkedModel.youTrackToken},enumerable:!0,configurable:!0}),t.prototype.onFileInputChanged=function(e){return s["a"](this,void 0,void 0,function(){var t,r;return s["d"](this,function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),this.isLoading=!0,t=e.target&&e.target.files||void 0,r=this.checkedModel,[4,this.onFileInputChangedImpl(t)];case 1:return r.times=n.sent(),[3,3];case 2:return this.$refs.fileInput.value="",this.isLoading=!1,[7];case 3:return[2]}})})},t.prototype.onReportNowClicked=function(e){return s["a"](this,void 0,void 0,function(){var e,t,n,o,i;return s["d"](this,function(s){switch(s.label){case 0:e=this.createYouTrack(),s.label=1;case 1:return s.trys.push([1,4,5,6]),this.isLoading=!0,o=Map.bind,[4,e.getWorkItemTypes()];case 2:return n=new(o.apply(Map,[void 0,s.sent().map(function(e){return[e.name,e.id]})])),[4,Promise.all(this.checkedModel.times.map(function(t){return r.createWorkItem(e,n,t)}))];case 3:return t=s.sent(),[3,6];case 4:return i=s.sent(),this.statusSnackbar.showError(r.getErrorMessage(i)),[2];case 5:return this.isLoading=!1,[7];case 6:return this.checkedModel.times=this.spentTimeUtility.subtractNewSpentTimes(t),this.statusSnackbar.showInfo("Spent time reported successfully."),[2]}})})},t.getErrorMessage=function(e){return e instanceof Error&&e.toString()||"Unknown Error!"},t.createWorkItem=function(e,t,r){var n=r.type&&t.get(r.type);if(r.type&&!n)throw new Error("The type "+r.type+" is not available. Please select a different type in the Excel file.");return e.createWorkItem(r.title,{date:r.date.getTime(),duration:{minutes:r.durationMinutes},text:r.comments.join("\n")||void 0,type:n&&{id:n}||void 0})},Object.defineProperty(t.prototype,"spentTimeUtility",{get:function(){if(!this.spentTimeUtilityImpl)throw new Error("spentTimeUtility is not set!");return this.spentTimeUtilityImpl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"checkedModel",{get:function(){if(!this.model)throw new Error("No model set!");return this.model},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"statusSnackbar",{get:function(){return this.$refs.statusSnackbar},enumerable:!0,configurable:!0}),t.prototype.createYouTrack=function(){if(!this.checkedModel.youTrackBaseUrl||!this.checkedModel.youTrackToken)throw new Error("YouTrack coordinates missing!");return new A(this.checkedModel.youTrackBaseUrl,this.checkedModel.youTrackToken)},t.prototype.onFileInputChangedImpl=function(e){return s["a"](this,void 0,void 0,function(){return s["d"](this,function(t){switch(t.label){case 0:if(this.fileError=null,this.networkError=null,this.$refs.excelFileField.focus(),!e||1!==e.length)throw new Error("Single file expected.");this.checkedModel.filename=e[0].name,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.process(e[0])];case 2:return[2,t.sent()];case 3:return t.sent(),this.noSpentTimeText=r.defaultNoSpentTimeText,[2,[]];case 4:return[2]}})})},t.prototype.process=function(e){return s["a"](this,void 0,void 0,function(){var t,n,o,i,a;return s["d"](this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=this,[4,U.create(e)];case 1:return t.spentTimeUtilityImpl=s.sent(),[3,3];case 2:throw n=s.sent(),this.fileError=r.getErrorMessage(n),n;case 3:o=this.createYouTrack(),s.label=4;case 4:return s.trys.push([4,6,,7]),[4,o.getCurrentUser()];case 5:return i=s.sent(),[3,7];case 6:throw a=s.sent(),this.networkError=r.getErrorMessage(a),a;case 7:return[2,this.subtractExisting(o,i)]}})})},t.prototype.subtractExisting=function(e,t){return s["a"](this,void 0,void 0,function(){var n,o;return s["d"](this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.spentTimeUtility.subtractExistingSpentTimes(e,t)];case 1:return n=i.sent(),[3,3];case 2:throw o=i.sent(),this.statusSnackbar.showError(r.getErrorMessage(o)),o;case 3:return this.noSpentTimeText="The Excel file does not contain any unreported spent time.",[2,n]}})})},t.defaultNoSpentTimeText="Upload your Excel file to see the unreported spent time.",s["b"]([Object(a["b"])()],t.prototype,"model",void 0),t=r=s["b"]([Object(a["a"])({components:{StatusSnackbar:$}})],t),t}(a["c"]),q=K,H=q,Y=(r("b318"),r("8fea")),G=r("4bd4"),J=r("8e36"),z=r("2677"),Q=Object(m["a"])(H,P,C,!1,null,null,null);Q.options.__file="Content.vue";var X=Q.exports;b()(Q,{VBtn:v["a"],VCard:g["a"],VCardTitle:w["a"],VContainer:x["a"],VDataTable:Y["a"],VFlex:E["a"],VForm:G["a"],VLayout:S["a"],VProgressLinear:J["a"],VTextField:z["a"]});var Z=function(){function e(){this.fileExtension=".xlsm",this.filename=null,this.times=new Array,this.youTrackBaseUrlImpl=e.getLocalStorage(e.youTrackBaseUrlKey),this.youTrackTokenImpl=e.getLocalStorage(e.youTrackTokenKey)}return Object.defineProperty(e.prototype,"title",{get:function(){return d.title},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"youTrackBaseUrl",{get:function(){return this.youTrackBaseUrlImpl},set:function(t){this.youTrackBaseUrlImpl=t,e.setLocalStorage(e.youTrackBaseUrlKey,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"youTrackToken",{get:function(){return this.youTrackTokenImpl},set:function(t){this.youTrackTokenImpl=t,e.setLocalStorage(e.youTrackTokenKey,t)},enumerable:!0,configurable:!0}),e.getLocalStorage=function(e){return window.localStorage.getItem(e)},e.setLocalStorage=function(e,t){t?window.localStorage.setItem(e,t):window.localStorage.removeItem(e)},e.youTrackBaseUrlKey="youTrackBaseUrl",e.youTrackTokenKey="youTrackToken",e}(),ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isDrawerVisible=!1,t.model=new Z,t}return s["c"](t,e),t.prototype.onMenuClicked=function(e){this.isDrawerVisible=!this.isDrawerVisible},t.prototype.onAboutClicked=function(e){this.isDrawerVisible=!1,this.$refs.aboutDialog.showDialog()},t=s["b"]([Object(a["a"])({components:{AboutDialog:I,Content:X}})],t),t}(a["c"]),te=ee,re=te,ne=r("7496"),oe=r("549c"),ie=r("132d"),se=r("8860"),ae=r("ba95"),ue=r("40fe"),ce=r("5d23"),le=r("f774"),de=r("71d9"),pe=r("706c"),fe=r("2a7f"),he=Object(m["a"])(re,o,i,!1,null,null,null);he.options.__file="App.vue";var me=he.exports;b()(he,{VApp:ne["a"],VContent:oe["a"],VIcon:ie["a"],VList:se["a"],VListTile:ae["a"],VListTileAction:ue["a"],VListTileContent:ce["a"],VListTileTitle:ce["b"],VNavigationDrawer:le["a"],VSpacer:M["a"],VToolbar:de["a"],VToolbarSideIcon:pe["a"],VToolbarTitle:fe["a"]});var ye=r("bb71");r("da64");n["default"].use(ye["a"],{iconfont:"md"}),n["default"].config.productionTip=!1,new n["default"]({render:function(e){return e(me)}}).$mount("#app")},e8f4:function(e,t,r){}});
//# sourceMappingURL=app.ed004669.js.map